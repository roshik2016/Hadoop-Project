1. Funding round types. (Utsav)


1. Most Popular and least popular market segment for starting a starup? (Based on investments)

DROP TABLE IF EXISTS PopMarket;
CREATE TABLE PopMarket
ROW FORMAT DELIMITED FIELDS TERMINATED BY '|' 
STORED AS TEXTFILE LOCATION 'wasbs://viggy@startupanalysis.blob.core.windows.net/Qn1/' 
AS 
select SUM(funding_total_usd) as TotalInvestment,market from companies where market IS NOT NULL group by market sort by TotalInvestment desc;

71019804460     Biotechnology
42243721029     Software
37629938855     Clean Technology
29492281582     Health Care
22432472663     E-Commerce


2. Safest State/city to start a startup.
DROP TABLE IF EXISTS Safest;
CREATE TABLE SafestCity
ROW FORMAT DELIMITED FIELDS TERMINATED BY '|' 
STORED AS TEXTFILE LOCATION 'wasbs://viggy@startupanalysis.blob.core.windows.net/Qn2/' 
AS 
select count(city) as TotalStartups, City from companies where status='operating' and City NOT LIKE '' group by city sort by TotalStartups desc; 

2056    San Francisco
1927    New York
1095    London
477     Austin
468     Cambridge

DROP TABLE IF EXISTS SafestCountry;
CREATE TABLE SafestCountry
ROW FORMAT DELIMITED FIELDS TERMINATED BY '|' 
STORED AS TEXTFILE LOCATION 'wasbs://viggy@startupanalysis.blob.core.windows.net/Qn2_1/' 
AS 
select count(country_code) as TotalStartups,country_code from companies where status='operating' and country_code NOT LIKE '' group by country_code sort by TotalStartups desc; 

23979   USA
2297    GBR
1182    CAN
1168    CHN
819     DEU


3. Total companies found by year and market segment.

select market,founded_year,count(founded_year) as Totalcounts from companies where founded_year>=2010 and founded_year<=2014 and market='Software' group by market,founded_year order by founded_year asc;
Software        2012    418
Software        2011    383
Software        2010    309
Software        2013    282
Software        2014    72

DROP TABLE IF EXISTS TotComp;
CREATE TABLE TotComp
ROW FORMAT DELIMITED FIELDS TERMINATED BY '|' 
STORED AS TEXTFILE LOCATION 'wasbs://viggy@startupanalysis.blob.core.windows.net/Qn3/' 
AS 
select market,founded_year,count(founded_year) as Totalcounts from companies where founded_year>=2000 and founded_year<=2014 group by market,founded_year order by founded_year asc,Totalcounts desc;

Software        2010    309
Biotechnology   2010    197
Mobile  2010    1796
E-Commerce      2010    171



4. Companies based on highest funding.

CREATE TABLE HighFunding 
ROW FORMAT DELIMITED FIELDS TERMINATED BY '|' 
STORED AS TEXTFILE LOCATION 'wasbs://viggy@startupanalysis.blob.core.windows.net/Qn4/' 
AS 
select name,market,status,funding_total_usd,country_code,city from companies order by funding_total_usd desc;

Zebra Technologies      Enterprise Software     operating       2000000000      USA     Lincolnshire
Quad/Graphics   Local Businesses        operating       1900000000      USA     Sussex
Solyndra        Manufacturing   closed  1567504319      USA     Fremont
Uber    Transportation  operating       1507450000      USA     San Francisco
Cardinal Health Hospitals       operating       1500000000      USA     Dublin


5. Average funding for a company based on market segment.

DROP TABLE IF EXISTS AvgFunding;
CREATE TABLE AvgFunding
ROW FORMAT DELIMITED FIELDS TERMINATED BY '|' 
STORED AS TEXTFILE LOCATION 'wasbs://viggy@startupanalysis.blob.core.windows.net/Qn5/' 
AS 
select market,cast(avg(funding_total_usd)as bigint) as average from companies group by market order by average desc;

https://startupanalysis.blob.core.windows.net/viggy
wasbs://viggy@startupanalysis.blob.core.windows.net/Avg/

Natural Gas Uses        400000000
Oil and Gas     171289122
Content Creators        121682222
Custom Retail   119657790
Solar   111146112

6. Best season for a startup based on quarter.
7. Finding company which has invested more. (By money and occurences)

By money:
DROP TABLE IF EXISTS CompInv;
CREATE TABLE CompInv
ROW FORMAT DELIMITED FIELDS TERMINATED BY '|' 
STORED AS TEXTFILE LOCATION 'wasbs://viggy@startupanalysis.blob.core.windows.net/Qn7/' 
AS 
select investor_name,investor_market,count(investor_name) as totalcnt,investor_country,sum(raised_amount_usd) as total from investments group by investor_name,investor_country,investor_market order by total desc;

By occurences:
select investor_name,investor_market,count(investor_name) as totalcnt,investor_country,sum(raised_amount_usd) as total from investments group by investor_name,investor_country,investor_market order by totalcnt desc limit 5;

Sequoia Capital Venture Capital 542     USA     7307078403
Intel Capital   Investment Management   487     USA     6717488577
New Enterprise Associates       Health Care     402     USA     9043273587
Accel Partners  Venture Capital 399     USA     6571895769
Draper Fisher Jurvetson (DFJ)   Venture Capital 398     USA     4728378346


8. Increase/decrease on networth for the acquired company. (Company wise / segment wise)
DROP TABLE IF EXISTS Networth;
CREATE TABLE Networth
ROW FORMAT DELIMITED FIELDS TERMINATED BY '|' 
STORED AS TEXTFILE LOCATION 'wasbs://viggy@startupanalysis.blob.core.windows.net/Qn8/' 
AS 
select distinct c.name,c.funding_total_usd,a.acquirer_name,a.price_amount,(a.price_amount - c.funding_total_usd) as acqvalue,c.market from companies c join acquirer a on (c.name = a.company_name) sort by acqvalue desc;

9. Companies with most funding rounds.
DROP TABLE IF EXISTS Fundrounds;
CREATE TABLE Fundrounds
ROW FORMAT DELIMITED FIELDS TERMINATED BY '|' 
STORED AS TEXTFILE LOCATION 'wasbs://viggy@startupanalysis.blob.core.windows.net/Qn9/' 
AS 
select name,market,funding_rounds from companies sort by funding_rounds desc;


10. Top 5 companies with highest acquisition value

DROP TABLE IF EXISTS HighAcq;
CREATE TABLE HighAcq
ROW FORMAT DELIMITED FIELDS TERMINATED BY '|' 
STORED AS TEXTFILE LOCATION 'wasbs://viggy@startupanalysis.blob.core.windows.net/Qn10/' 
AS 
select company_name, company_market, sum(price_amount) as Totalprice from acquirer group by company_name,company_market sort by Totalprice desc;

11. City/region from where highest acquistions were made.

DROP TABLE IF EXISTS HighAcqCity;
CREATE TABLE HighAcqCity
ROW FORMAT DELIMITED FIELDS TERMINATED BY '|' 
STORED AS TEXTFILE LOCATION 'wasbs://viggy@startupanalysis.blob.core.windows.net/Qn11/' 
AS 
select acquirer_state, count(acquirer_state) as acqcnt from acquirer where acquirer_state != '' group by acquirer_state sort by acqcnt desc;
